---
icon: edit
date: 2023-09-17
category:
  - 学习笔记
  - 计算机网络
tag:
  - 笔记
  - 计算机网络
star: 30917
sticky: false
---

# HTTP的基本概念

## HTTP协议的定义

HTTP是`HyperText Transfer Protocol`由的单词都字母组成，它的完整名称是超文本传输协议。

它由三部分组成：超文本、传输、协议

### 超文本：

**文本**它是HTTP传输的内容，现在互联网上的内容已经拓展至图片、视频、文件、压缩包等，在 HTTP 眼里这些都算作「文本」。

**超文本**顾名思义就是**超越了普通文本的文本**，它是文字、图片、视频等的混合体，**最关键有超链接**，能从一个超文本跳转到另外一个超文本。

而我们常说的HTML（超文本标记语言）所构成的文本文件就是最常见的超文本了，它本身只是**纯文字文件**，但内部用很多标签定义了图片、视频等的链接，再经过浏览器的解释，呈现给我们的就是一个文字、有画面的网页了。

### 传输：

HTTP 协议是一个**双向协议**。当我们在浏览器导航栏输入一串网址后浏览器首先对URL进行解析，解析完成后浏览器就可以确定 Web 服务器和文件名，接下来就是根据这些信息来生成 HTTP 请求消息了。

此时我们就会发现其实浏览器和服务器能够请求和应答是因为有一种协议来进行通信，这种协议就是HTTP。虽然数据在浏览器和服务器之间传输了，但是它们也并没有直接沟通中间任然通过了其他中转和接力。

而在 HTTP 里，需要中间人遵从 HTTP 协议，只要不打扰基本的数据传输，就可以添加任意额外的东西。HTTP 是一个在计算机世界里专门用来在**两点之间传输数据**的约定和规范。

### 协议：

HTTP 是一个用在计算机世界里的**协议**。它使用计算机能够理解的语言确立了一种计算机之间交流通信的规范（**两个以上的参与者**），以及相关的各种控制和错误处理方式（**行为约定和规范**）。

### 总结

HTTP是一个用于在Web浏览器和Web服务器之间传输数据的协议。它是一个无状态的协议，意味着它不会记录之前的请求和响应信息。HTTP的内容可以是网页、图片、视频等多种多样的数据类型。通常，HTTP的内容以HTML、CSS、JavaScript等语言编写。这些内容可以通过HTTP方法（如GET、POST等）在客户端和服务器之间交互。通过HTTP，我们可以通过URL地址访问网页，发送表单数据，上传文件，以及进行其他各种与服务器交互的操作。

## HTTP消息的格式

当Web浏览器在确认了Web服务器和文件路径文件名之后，就可以根据这些信息来生成HTTP请求消息。

![](https://cdn.xiaolincoding.com/gh/xiaolincoder/ImageHost/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E9%94%AE%E5%85%A5%E7%BD%91%E5%9D%80%E8%BF%87%E7%A8%8B/4.jpg)

## HTTP的状态

HTTP状态码是指服务器用来表示HTTP请求处理结果的一个数字代码。虽然HTTP是无状态的协议，但是通过使用状态码，服务器可以向客户端提供关于请求的处理情况的信息。

HTTP状态码主要分为以下几类：

| 状态码 | 含义                                                         |
| ------ | ------------------------------------------------------------ |
| 1xx类  | 属于**提示信息**，是协议处理中的一种中间状态，实际用到的比较少。 |
| 100    | `Continue`继续。客户端应继续其请求                           |
| 101    | `Switching Protocols`切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议 |
| 2xx类  | 表示服务器**成功**处理了客户端的请求，也是我们最愿意看到的状态。 |
| 200    | `OK`最常见的成功状态码，表示一切正常。如果是非 `HEAD` 请求，服务器返回的响应头都会有 body 数据。 |
| 202    | `Accepted` 已接受。已经接受请求，但未处理完成.               |
| 204    | `Not Content`也是常见的成功状态码，与 200 OK 基本相同，但响应头没有 body 数据。 |
| 205    | `Non-Authoritative Information` 非授权信息。请求成功。但返回的meta信息不在原始的服务器，而是一个副本 |
| 206    | `Partial Content`是应用于 HTTP 分块下载或断点续传，表示响应返回的 body 数据并不是资源的全部，而是其中的一部分，也是服务器处理成功的状态。 |
| 3xx类  | 表示客户端请求的资源发生了变动，需要客户端用新的 URL 重新发送请求获取资源，也就是**重定向**。 |
| 301    | `Moved Permanently`表示永久重定向，说明请求的资源已经不存在了，需改用新的 URL 再次访问。 |
| 302    | `Found`表示临时重定向，说明请求的资源还在，但暂时需要用另一个 URL 来访问。 |
| 304    | `Not Modified`不具有跳转的含义，表示资源未修改，重定向已存在的缓冲文件，也称缓存重定向，也就是告诉客户端可以继续使用缓存资源，用于缓存控制。 |
| 4xx类  | 表示客户端发送的**报文有误**，服务器无法处理，也就是错误码的含义。 |
| 400    | `Bad Request`表示客户端请求的报文有错误，但只是个笼统的错误。 |
| 403    | `Forbidden`表示服务器禁止访问资源，并不是客户端的请求出错。  |
| 404    | `Not Found`表示请求的资源在服务器上不存在或未找到，所以无法提供给客户端。 |
| 5xx类  | 表示客户端请求报文正确，但是**服务器处理时内部发生了错误**，属于服务器端的错误码。 |
| 500    | `Internal Server Error`与 400 类型，是个笼统通用的错误码，服务器发生了什么错误，我们并不知道。 |
| 501    | `Not Implemented`表示客户端请求的功能还不支持，类似“即将开业，敬请期待”的意思。 |
| 502    | `Bad Gateway`通常是服务器作为网关或代理时返回的错误码，表示服务器自身工作正常，访问后端服务器发生了错误。（服务端向另一个服务器发请求失败） |
| 503    | `Service Unavailable`表示服务器当前很忙，暂时无法响应客户端，类似“网络服务正忙，请稍后重试”的意思。 |

::: tip

301 和 302 都会在响应头里使用字段 `Location`，指明后续要跳转的 URL，浏览器会自动重定向新的 URL。

403通常是用户登录令牌过期或者出错（token过期）

:::

## HTTP的常用字段

### 分类

`General Headers`：通用头信息，同时适用于请求头和响应头，但与最终消息传输的数据无关的消息头。

`Request Headers`：从客户端向服务器发送请求报文时使用的首部。

- 作用：是请求报文特有的，为服务器提供了一些额外信息，比如客户端希望接收什么类型的数据，如 Accept 头部。补充了请求的附加内容、客户端信息、响应内容相关优先级等信息。

`Response Headers`：从服务器端向客户端返回响应报文时使用的首部。

- 作用：便于客户端提供信息。客服端在与哪种类型的服务器进行交互，如 Server 头部。补充了响应时的附加内容，也会要求客户端附加额外的内容信息。

### General Headers:

| 字段              | 含义                                                         |
| ----------------- | ------------------------------------------------------------ |
| Connection        | 连接管理                                                     |
| Cache-Control     | 控制缓存机制，指定缓存策略，如缓存的有效期、是否可以缓存等   |
| Date              | 创建报文的日期                                               |
| Pragma            | Pragma头字段用于控制缓存行为、提高兼容性、防止缓存劫持以及隐藏敏感信息。然而，它在现代的HTTP协议中已经被Cache-Control头字段所取代 |
| Transfer-Encoding | 指定报文传输主体的编码方式                                   |
| Warning           | 警告信息                                                     |
| Keep-Alive        | 用来设置超时时长和最大请求数                                 |

::: tip

`Connection` 字段最常用于客户端要求服务器使用「HTTP 长连接」机制，以便其他请求复用。

HTTP 长连接的特点是，只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。

HTTP/1.1 版本的默认连接都是长连接，但为了兼容老版本的 HTTP，需要指定 `Connection` 首部字段的值为 `Keep-Alive`。开启了 HTTP Keep-Alive 机制后， 连接就不会中断，而是保持连接。当客户端发送另一个请求时，它会使用同一个连接，一直持续到客户端或服务器端提出断开连接。

:::

### Request Header：

| 字段          | 含义                                   |
| ------------- | -------------------------------------- |
| Host          | 指定目标服务器的域名或 IP 地址         |
| User-Agent    | 发送请求的用户代理（通常是浏览器标识） |
| Accept        | 指定客户端（浏览器）可以接受的内容类型 |
| Content-Type  | 指定请求体的媒体类型                   |
| Authorization | 提供身份验证凭据，用于访问受保护的资源 |
| Referer       | 指定当前请求的来源页面 URL             |

### Response Header:

| 字段                        | 含义                                                         |
| --------------------------- | ------------------------------------------------------------ |
| Content-Length              | 指定响应体的长度（以字节为单位）                             |
| Cache-Control               | 指定缓存策略，如缓存的有效期、是否可以缓存等                 |
| Set-Cookie                  | 在客户端设置 Cookie                                          |
| Location                    | 指定重定向的目标 URL                                         |
| Access-Control-Allow-Origin | 指定允许跨域请求的来源（CORS）                               |
| Content-Type                | 指定实体标签，用于缓存验证                                   |
| Content-Encoding            | 字段说明数据的压缩方法，表示服务器返回的数据使用了什么压缩格式（gzip，deflate） |

::: tip

`Content-Type` 字段用于服务器回应时，告诉客户端，本次数据是什么格式Content-Type 值及其用途：

1. `text/plain`：纯文本类型，没有指定字符集，默认使用 ASCII 编码。
2. `text/html`：HTML 文档类型，用于表示网页内容。
3. `text/css`：CSS 文件类型，用于表示样式表。
4. `application/json`：JSON 数据类型，用于表示结构化数据。
5. `application/xml`：XML 数据类型，用于表示可扩展标记语言数据。application/octet-stream：二进制流数据类型，用于表示任意二进制数据。
6. `multipart/form-data`：用于在 HTML 表单中上传文件时，将表单数据和文件一起提交。`image/jpeg`、`image/png`、`image/gif`：用于表示不同格式的图像文件。

:::
## 什么是强制缓存

强缓存指的是只要浏览器判断缓存没有过期，则直接使用浏览器的本地缓存，决定是否使用缓存的主动性在于浏览器这边。

如下图中，返回的是 200 状态码，但在 size 项中标识的是 `from disk cache`，就是使用了强制缓存。

![](https://cdn.xiaolincoding.com//mysql/other/1cb6bc37597e4af8adfef412bfc57a42.png)

强缓存是利用下面这两个 HTTP 响应头部字段实现的，它们都用来表示资源在客户端缓存的有效期：

- `Cache-Control`， 是一个相对时间；
- `Expires`，是一个绝对时间；

如果 HTTP 响应头部同时有 Cache-Control 和 Expires 字段的话，**Cache-Control 的优先级高于 Expires** 。

